!function(t){function e(e){for(var i,o,h=e[0],a=e[1],l=e[3]||[],d=0,u=[];d<h.length;d++)o=h[d],Object.prototype.hasOwnProperty.call(s,o)&&s[o]&&u.push(s[o][0]),s[o]=0;for(i in a)Object.prototype.hasOwnProperty.call(a,i)&&(t[i]=a[i]);for(c&&c(e),l.forEach((function(t){if(void 0===s[t]){s[t]=null;var e=document.createElement("link");r.nc&&e.setAttribute("nonce",r.nc),e.rel="prefetch",e.as="script",e.href=n(t),document.head.appendChild(e)}}));u.length;)u.shift()()}var i={},s={2:0};function n(t){return r.p+""+({0:"./dictionaryChinese",1:"./dictionaryEnglish"}[t]||t)+".bundle.js"}function r(e){if(i[e])return i[e].exports;var s=i[e]={i:e,l:!1,exports:{}};return t[e].call(s.exports,s,s.exports,r),s.l=!0,s.exports}r.e=function(t){var e=[],i=s[t];if(0!==i)if(i)e.push(i[2]);else{var o=new Promise((function(e,n){i=s[t]=[e,n]}));e.push(i[2]=o);var h,a=document.createElement("script");a.charset="utf-8",a.timeout=120,r.nc&&a.setAttribute("nonce",r.nc),a.src=n(t);var c=new Error;h=function(e){a.onerror=a.onload=null,clearTimeout(l);var i=s[t];if(0!==i){if(i){var n=e&&("load"===e.type?"missing":e.type),r=e&&e.target&&e.target.src;c.message="Loading chunk "+t+" failed.\n("+n+": "+r+")",c.name="ChunkLoadError",c.type=n,c.request=r,i[1](c)}s[t]=void 0}};var l=setTimeout((function(){h({type:"timeout",target:a})}),12e4);a.onerror=a.onload=h,document.head.appendChild(a)}return Promise.all(e)},r.m=t,r.c=i,r.d=function(t,e,i){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)r.d(i,s,function(e){return t[e]}.bind(null,s));return i},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r.oe=function(t){throw console.error(t),t};var o=window.webpackJsonp=window.webpackJsonp||[],h=o.push.bind(o);o.push=e,o=o.slice();for(var a=0;a<o.length;a++)e(o[a]);var c=h,l=r(r.s=2);e([[],{},0,[0,1]])}([function(module,__webpack_exports__,__webpack_require__){"use strict";function asyncGeneratorStep(t,e,i,s,n,r,o){try{var h=t[r](o),a=h.value}catch(t){return void i(t)}h.done?e(a):Promise.resolve(a).then(s,n)}function _asyncToGenerator(t){return function(){var e=this,i=arguments;return new Promise((function(s,n){var r=t.apply(e,i);function o(t){asyncGeneratorStep(r,s,n,o,h,"next",t)}function h(t){asyncGeneratorStep(r,s,n,o,h,"throw",t)}o(void 0)}))}}function ownKeys(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,s)}return i}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(i),!0).forEach((function(e){_defineProperty(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):ownKeys(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function _defineProperty(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}__webpack_require__.d(__webpack_exports__,"a",(function(){return UI}));class UI{static styleTooltip(){var t={position:"relative",display:"inline-block"},e=_objectSpread(_objectSpread({},t),{},{display:"none",backgroundColor:"black",color:"#fff",textAlign:"left",borderRadius:"6px",padding:"5px 0",position:"absolute",zIndex:"1"});Object.assign(document.querySelector("#cheat-tooltiptext").style,e),Object.assign(document.querySelector("#cheat-tooltip").style,t)}static handleClipboard(){function t(t){navigator.clipboard?navigator.clipboard.writeText(t).then(()=>{console.log("Async: Copying to clipboard was successful!")},t=>{console.error("Async: Could not copy text: ",t)}):function(t){var e=document.createElement("textarea");e.value=t,e.style.top="0",e.style.left="0",e.style.position="fixed",document.body.appendChild(e),e.focus(),e.select();try{var i=document.execCommand("copy")?"successful":"unsuccessful";console.log("Fallback: Copying text command was "+i)}catch(t){console.error("Fallback: Oops, unable to copy",t)}document.body.removeChild(e)}(t)}document.querySelector("#clipboard").addEventListener("click",(function(){t("edward@utexas.edu"),this.style.height="30px",setTimeout(function(){this.style.height="25px"}.bind(this),500)}))}static ensureSorted(t){var e=t.sort((t,e)=>e[0]-t[0]);return{sorted:e,noInconsistency:JSON.stringify(e)===JSON.stringify(t)}}static fetchScores(){return _asyncToGenerator((function*(){var t,e=Object.freeze([[123,"Edward"],[50,"John"],[30,"Crono"],[25,"Scala"],[15,"Robo"]]);try{t=yield fetch("highscore").then(t=>t.json())}catch(i){console.log(i),t=e}finally{UI.createScoreTable(t)}}))()}static createScoreTable(t){var{noInconsistency:e,sorted:i}=this.ensureSorted(t);if(!e)throw"high scores' broken";var s=document.createTextNode.bind(document),n=document.querySelector("#highscore");for(var[r,[o,h]]of Object.entries(t))n.appendChild(s("".concat(++r,". ").concat(h," scored ").concat(o))),n.appendChild(document.createElement("br"));n.style.position="absolute",UI.attachTableToCanvasRight(n)}static attachTableToCanvasRight(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];t.style.display="block";var i=document.getElementById("canvas");t.style.left=10+i.getBoundingClientRect().right+"px",t.style.top=i.getBoundingClientRect().y+"px",e&&window.addEventListener("resize",()=>this.attachTableToCanvasRight(t,!1))}static attachChatToCanvasLeft(){var t=document.querySelector("#chatroom"),e=document.getElementById("canvas");t.style.position="absolute",t.style.left="50px",t.style.width=e.getBoundingClientRect().left-30+"px",t.style.height=e.getBoundingClientRect().height+"px",t.style.top=e.getBoundingClientRect().y+"px"}static deleteScores(){console.log("delete",this);var t=document.querySelector("#highscore");t.innerHTML=t.innerHTML.split("</h1>")[0]}static destroyerOfObjects(){for(var prop in window.game)eval("delete window.game.".concat(prop," "))}static addCheats(){var t=document.querySelector.bind(globalThis.document),e=t("a[href='https://www.linkedin.com/in/edzhou/']"),i=(t("a[href='https://github.com/featurerich1/']"),t("a[href^='mailto']"));e.addEventListener("click",()=>{window.game.onSplash||(window.game.rate=2*window.game.rate)},!1),i.addEventListener("mouseenter",()=>{window.game.onSplash||(window.game.rate=.66*window.game.rate)},!1)}}},function(t,e,i){"use strict";var s,n="object"==typeof Reflect?Reflect:null,r=n&&"function"==typeof n.apply?n.apply:function(t,e,i){return Function.prototype.apply.call(t,e,i)};s=n&&"function"==typeof n.ownKeys?n.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)};var o=Number.isNaN||function(t){return t!=t};function h(){h.init.call(this)}t.exports=h,h.EventEmitter=h,h.prototype._events=void 0,h.prototype._eventsCount=0,h.prototype._maxListeners=void 0;var a=10;function c(t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}function l(t){return void 0===t._maxListeners?h.defaultMaxListeners:t._maxListeners}function d(t,e,i,s){var n,r,o,h;if(c(i),void 0===(r=t._events)?(r=t._events=Object.create(null),t._eventsCount=0):(void 0!==r.newListener&&(t.emit("newListener",e,i.listener?i.listener:i),r=t._events),o=r[e]),void 0===o)o=r[e]=i,++t._eventsCount;else if("function"==typeof o?o=r[e]=s?[i,o]:[o,i]:s?o.unshift(i):o.push(i),(n=l(t))>0&&o.length>n&&!o.warned){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=t,a.type=e,a.count=o.length,h=a,console&&console.warn&&console.warn(h)}return t}function u(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function p(t,e,i){var s={fired:!1,wrapFn:void 0,target:t,type:e,listener:i},n=u.bind(s);return n.listener=i,s.wrapFn=n,n}function m(t,e,i){var s=t._events;if(void 0===s)return[];var n=s[e];return void 0===n?[]:"function"==typeof n?i?[n.listener||n]:[n]:i?function(t){for(var e=new Array(t.length),i=0;i<e.length;++i)e[i]=t[i].listener||t[i];return e}(n):y(n,n.length)}function f(t){var e=this._events;if(void 0!==e){var i=e[t];if("function"==typeof i)return 1;if(void 0!==i)return i.length}return 0}function y(t,e){for(var i=new Array(e),s=0;s<e;++s)i[s]=t[s];return i}Object.defineProperty(h,"defaultMaxListeners",{enumerable:!0,get:function(){return a},set:function(t){if("number"!=typeof t||t<0||o(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");a=t}}),h.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},h.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||o(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this},h.prototype.getMaxListeners=function(){return l(this)},h.prototype.emit=function(t){for(var e=[],i=1;i<arguments.length;i++)e.push(arguments[i]);var s="error"===t,n=this._events;if(void 0!==n)s=s&&void 0===n.error;else if(!s)return!1;if(s){var o;if(e.length>0&&(o=e[0]),o instanceof Error)throw o;var h=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw h.context=o,h}var a=n[t];if(void 0===a)return!1;if("function"==typeof a)r(a,this,e);else{var c=a.length,l=y(a,c);for(i=0;i<c;++i)r(l[i],this,e)}return!0},h.prototype.addListener=function(t,e){return d(this,t,e,!1)},h.prototype.on=h.prototype.addListener,h.prototype.prependListener=function(t,e){return d(this,t,e,!0)},h.prototype.once=function(t,e){return c(e),this.on(t,p(this,t,e)),this},h.prototype.prependOnceListener=function(t,e){return c(e),this.prependListener(t,p(this,t,e)),this},h.prototype.removeListener=function(t,e){var i,s,n,r,o;if(c(e),void 0===(s=this._events))return this;if(void 0===(i=s[t]))return this;if(i===e||i.listener===e)0==--this._eventsCount?this._events=Object.create(null):(delete s[t],s.removeListener&&this.emit("removeListener",t,i.listener||e));else if("function"!=typeof i){for(n=-1,r=i.length-1;r>=0;r--)if(i[r]===e||i[r].listener===e){o=i[r].listener,n=r;break}if(n<0)return this;0===n?i.shift():function(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}(i,n),1===i.length&&(s[t]=i[0]),void 0!==s.removeListener&&this.emit("removeListener",t,o||e)}return this},h.prototype.off=h.prototype.removeListener,h.prototype.removeAllListeners=function(t){var e,i,s;if(void 0===(i=this._events))return this;if(void 0===i.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==i[t]&&(0==--this._eventsCount?this._events=Object.create(null):delete i[t]),this;if(0===arguments.length){var n,r=Object.keys(i);for(s=0;s<r.length;++s)"removeListener"!==(n=r[s])&&this.removeAllListeners(n);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(e=i[t]))this.removeListener(t,e);else if(void 0!==e)for(s=e.length-1;s>=0;s--)this.removeListener(t,e[s]);return this},h.prototype.listeners=function(t){return m(this,t,!0)},h.prototype.rawListeners=function(t){return m(this,t,!1)},h.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):f.call(t,e)},h.prototype.listenerCount=f,h.prototype.eventNames=function(){return this._eventsCount>0?s(this._events):[]}},function(t,e,i){"use strict";i.r(e);class s{constructor(t,e){this.x=t,this.y=e}animate(){}get location(){return{x:this.x,y:this.y}}}var n=class extends s{constructor(t,e,i,s,n,r,o,h,a,c){super(t,e),this.canvas=i,this.ctx=s,this.alive=!0,this.animate=this.animate.bind(this),this.animateDeath=this.animateDeath.bind(this),this.imp=n,this.difficulty=r,this.standStill=!1,this.bluepaint=o,this.gameMode=h,this.squarereticle=a,this.dictionary=c,this.word=this.dictionary[Math.floor(Math.random()*this.dictionary.length)],document.querySelector("#soundToggle").checked&&new Audio("./word/".concat(this.word)).play()}static CreateEnemy(){}animateReticle(){this.ctx.drawImage(this.squarereticle,0,0,400,400,this.x-5,this.y-5,55,55)}animate(t,e){if(!0===this.alive&&!1===this.standStill){var i=Math.random();t>this.x?i<.7?this.x+=1:i>=.7&&i<.99?this.x-=1:(this.standStill=!0,setTimeout(()=>this.standStill=!1,3e3)):t<this.x&&(i<.7?this.x-=1:i>=.7&&i<.99?this.x+=1:(this.standStill=!0,setTimeout(()=>this.standStill=!1,3e3))),e>this.y?i<.7?this.y+=1:i>=.7&&i<.99?this.y-=1:(this.standStill=!0,setTimeout(()=>this.standStill=!1,3e3)):e<this.y&&(i<.7?this.y-=1:i>=.7&&i<.99?this.y+=1:(this.standStill=!0,setTimeout(()=>this.standStill=!1,3e3)))}!0===this.alive?(this.ctx.drawImage(this.imp,0,0,200,300,this.x,this.y,500,500),this.ctx.fillStyle="white",this.ctx.font="bold 50px ChronoType",this.ctx.fillText(this.word,this.x,this.y,500,500)):!1===this.alive&&this.ctx.drawImage(this.bluepaint,0,0,500,500,this.x,this.y,60,60)}animateDeath(){}wander(){}};var r=class extends s{constructor(t,e,i,s,n,r,o,h,a,c,l){super(t,e),this.canvas=i,this.ctx=s,this.alive=!0,this.animate=this.animate,this.animateDeath=this.animateDeath.bind(this),this.cronoleftimg=n,this.cronorightimg=r,this.cronoupimg=o,this.cronodownimg=h,this.lastaction=this.cronodownimg,this.cronothrust=a,this.keys=c,this.enemies=l,this.hp=100,this.sprites=document.getElementById("sprites"),this.takingDamage=!1,this.animateGrimace=!1}poll(){}checkCollision(){for(var t of this.enemies)!1!==t.alive&&((t.x-this.x)**2+(t.y-this.y)**2)**.5<20&&this.takeDamage()}takeDamage(){!1===this.takingDamage?(this.hp--,this.takingDamage=!0,this.animateGrimace=!0,setTimeout(()=>{this.takingDamage=!1},5e3)):(this.takingDamage=!0===this.animateGrimace)&&(this.ctx.drawImage(this.sprites,80,80,30,30,this.x,this.y,50,50),setTimeout(()=>this.animateGrimace=!1,500))}animateAttack(t,e,i){var s,n;this.circleCenterY=(this.y+e)/2,this.circleCenterX=(this.x+t)/2,this.diameter=Math.pow(Math.pow(this.x-t,2)+Math.pow(this.y-e,2),.5),this.x<t?(s=this.y,n=this.x):(s=e,n=t),this.angleStartClockwise=-Math.atan((s-this.circleCenterY)/(this.circleCenterX-n))+Math.PI,this.angleEndClockwise=Math.PI+this.angleStartClockwise,this.x=t,this.y=e,this.ctx.drawImage(i,0,0,500,500,this.x,this.y+50,500,500),this.lastaction=i}animate(){var t=this.keys[38],e=this.keys[40],i=this.keys[37],s=this.keys[39];s&&(this.x<this.canvas.width-30&&!e&&!t?(this.x+=4,this.animateGrimace||this.ctx.drawImage(this.cronorightimg,0,0,500,500,this.x,this.y,500,500)):this.x>-30&&(e||t)&&(this.x+=2.8),this.lastaction=this.cronorightimg),i&&(this.x>-30&&!e&&!t?(this.x-=4,this.animateGrimace||this.ctx.drawImage(this.cronoleftimg,0,0,500,500,this.x,this.y,500,500)):this.x>-30&&(e||t)&&(this.x-=2.8),this.lastaction=this.cronoleftimg),e&&(this.y<this.canvas.height-30&&!i&&!s?this.y+=4:this.y<this.canvas.height-30&&(i||s)&&(this.y+=2.8),this.animateGrimace||this.ctx.drawImage(this.cronodownimg,0,0,500,500,this.x,this.y,500,500),this.lastaction=this.cronodownimg),t&&!e&&(this.y>-30&&!i&&!s?this.y-=4:this.y>-30&&(i||s)&&(this.y-=2.8),this.animateGrimace||this.ctx.drawImage(this.cronoupimg,0,0,500,500,this.x,this.y,500,500),this.lastaction=this.cronoupimg),i||t||s||s||e||this.takingDamage||this.animateGrimace||this.ctx.drawImage(this.lastaction,0,0,500,500,this.x,this.y,500,500)}animateDeath(){}};class o{constructor(){this.trie={}}addWord(t){var e=this.trie;for(var i of t)e.hasOwnProperty(i)||(e[i]={}),e=e[i];e.finished=t}possibilities(t){var e=[];if(0===t.length)return e;var i=this.trie;for(var s of t){if(!i.hasOwnProperty(s))return e;i=i[s]}return function t(i){for(var s in i)"finished"===s?e.push(i[s]):t(i[s])}(i),e}}var h=i(0);function a(t,e,i,s,n,r,o){try{var h=t[r](o),a=h.value}catch(t){return void i(t)}h.done?e(a):Promise.resolve(a).then(s,n)}function c(t){return function(){var e=this,i=arguments;return new Promise((function(s,n){var r=t.apply(e,i);function o(t){a(r,s,n,o,h,"next",t)}function h(t){a(r,s,n,o,h,"throw",t)}o(void 0)}))}}i(1);var l=new WeakSet;class d{constructor(){l.add(this),this._getResources(),this._ensureDefaultSettings(),this._addListeners(),this.animateSplash();var t=setInterval(()=>{this.onSplash||(clearInterval(t),function(t,e,i){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return i}(this,l,u).call(this))},2e3)}remakeGame(){}get hasGameStarted(){return!this.onSplash}get language(){return this.gameMode}set setHP(t){this.player.hp=t}ensureDefaultCTX(){this.ctx.lineWidth=1,this.ctx.shadowOffsetX=0,this.ctx.shadowOffsetY=0,this.ctx.strokeWeight=null}animateSplash(){console.log("SPLASH ANIMATION"),this.ensureDefaultCTX(),this.ctx.drawImage(this.splash,0,0,1200,900,0,0,this.canvas.width,this.canvas.height),this.ctx.font="bold 100px ChronoType",this.ctx.fillStyle="black",this.ctx.strokeStyle="white",this.ctx.strokeText("TYPING FANTASY!",.1*this.canvas.width-2,97),this.ctx.fillText("TYPING FANTASY!",.1*this.canvas.width,100),this.ctx.font="bold 50px ChronoType",this.ctx.fillStyle="black",this.ctx.strokeStyle="white",this.ctx.strokeText("Choose a TYPING LANGUAGE and hit ENTER!",.05*this.canvas.width-2,.5*this.canvas.height-3),this.ctx.fillText("Choose a TYPING LANGUAGE and hit ENTER!",.05*this.canvas.width,.5*this.canvas.height),this.ctx.strokeText("ENGLISH 5-letter words",.1*this.canvas.width-2,.6*this.canvas.height-3),this.ctx.fillText("ENGLISH 5-letter words",.1*this.canvas.width,.6*this.canvas.height),this.ctx.strokeText("CHINESE idioms",.1*this.canvas.width-2,.7*this.canvas.height-3),this.ctx.fillText("CHINESE idioms",.1*this.canvas.width,.7*this.canvas.height);var t=this.keys[38];this.keys[40]&&"english"===this.gameMode?this.gameMode="chinese":t&&"chinese"===this.gameMode&&(this.gameMode="english"),"english"===this.gameMode?this.ctx.drawImage(this.cursor,0,0,32,32,25,320,50,50):"chinese"===this.gameMode&&this.ctx.drawImage(this.cursor,0,0,32,32,25,380,50,50),!0===this.onSplash&&requestAnimationFrame(t=>{this.animateSplash(t)})}_ensureDefaultSettings(){this.isGameover=this.isGameover||!1,this.isPaused=this.isPaused||!1,this.gameMode=this.gameMode||"english",this.onSplash=this.onSplash||!0,this.lastTimeElapsed=this.lastTimeElapsed||0,this.rate=this.rate||2e3}drawAttackArc(){this.player.circleCenterY&&(this.ctx.beginPath(),this.ctx.arc(this.player.circleCenterX,this.player.circleCenterY,this.player.diameter/2,this.player.angleStartClockwise,this.player.angleEndClockwise,!1),this.ctx.strokeStyle="#FFFF00",this.ctx.lineWidth=2,this.ctx.lineCap="round",this.ctx.stroke(),this.ctx.closePath(),this.ctx.beginPath(),this.ctx.arc(this.player.circleCenterX,this.player.circleCenterY,this.player.diameter/2+10,this.player.angleStartClockwise,this.player.angleEndClockwise,!1),this.ctx.strokeStyle="#FFFF00",this.ctx.lineWidth=1,this.ctx.lineCap="round",this.ctx.stroke(),this.ctx.closePath())}drawMap(){this.ctx.drawImage(this.forestbg,0,0,500,350,0,0,this.canvas.width,this.canvas.height-50)}drawEnemies(){this.ensureDefaultCTX();for(var t=this.trie.possibilities(this.word.join("")),e=0;e<this.enemies.length;e++)this.enemies[e].animate(this.player.x,this.player.y),t.includes(this.enemies[e].word)&&!0===this.enemies[e].alive&&this.enemies[e].animateReticle()}drawChineseEnemies(){this.ensureDefaultCTX();for(var t=this.trie.possibilities(this.word),e=0;e<this.enemies.length;e++)this.enemies[e].animate(this.player.x,this.player.y),t.includes(this.enemies[e].word)&&!0===this.enemies[e].alive&&this.enemies[e].animateReticle()}drawChineseTypingArea(){this.ensureDefaultCTX(),this.fontSize=this.fontSize||50,this.ctx.clearRect(0,this.canvas.height-this.fontSize,this.canvas.width,this.fontSize),this.ctx.fillStyle="grey",this.ctx.fillRect(0,this.canvas.height-this.fontSize,this.canvas.width,this.fontSize),this.ctx.fillStyle="blue",this.ctx.font="bold ".concat(this.fontSize,"px ChronoType")}drawTypingArea(){this.fontSize=this.fontSize||50,this.ctx.clearRect(0,this.canvas.height-this.fontSize,this.canvas.width,this.fontSize),this.ctx.fillStyle="grey",this.ctx.fillRect(0,this.canvas.height-this.fontSize,this.canvas.width,this.fontSize),this.ctx.fillStyle="blue",this.ctx.font="bold ".concat(this.fontSize,"px ChronoType"),this.ctx.fillText(this.word.join(""),0,this.canvas.height)}drawWPM(){this.isPaused&&!this.timeOfPauseStart&&(this.timeOfPauseStart=Date.now()),!this.isPaused&&this.timeOfPauseStart&&(this.then=this.then+(Date.now()-this.timeOfPauseStart),this.timeOfPauseStart=null),void 0===this.then&&(this.then=Date.now()),this.now=Date.now(),this.time=parseInt((this.now-this.then)/1e3),this.wpm=parseInt(this.destroyedCount/(this.time/60))||0,this.ctx.fillStyle="blue",this.ctx.font="bold ".concat(this.fontSize,"px ChronoType"),this.ctx.fillText("Time: "+this.time+"  WPM: "+this.wpm,this.canvas.width-600,this.canvas.height)}drawHeart(){this.ctx.beginPath(),this.ctx.strokeStyle="#000000",this.ctx.strokeWeight=3,this.ctx.shadowOffsetX=4,this.ctx.shadowOffsetY=4,this.ctx.lineWidth=10,this.ctx.fillStyle="#FF0000";var t=560;this.ctx.moveTo(t,567.5),this.ctx.quadraticCurveTo(t,t,567.5,t),this.ctx.quadraticCurveTo(575,t,575,567.5),this.ctx.quadraticCurveTo(575,t,582.5,t),this.ctx.quadraticCurveTo(590,t,590,567.5),this.ctx.quadraticCurveTo(590,575,582.5,582.5),this.ctx.lineTo(575,590),this.ctx.lineTo(567.5,582.5),this.ctx.quadraticCurveTo(t,575,t,567.5),this.ctx.stroke(),this.ctx.fill(),this.ctx.closePath(),this.ctx.fillStyle="blue",this.ctx.font="bold ".concat(this.fontSize,"px ChronoType"),this.ctx.fillText("".concat(this.player.hp),this.canvas.width-195,this.canvas.height)}animate(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(!this.isPaused&&!this.isGameover){if(this.player.hp<=0)return this.isGameover=!0,this.ctx.font="bold 60px ChronoType",this.ctx.fillStyle="red",this.ctx.fillText("GAMEOVER",.4*this.canvas.width,.5*this.canvas.height),void this.gameover();switch(t-this.lastTimeElapsed>this.rate&&(this.spawnEnemy(),this.lastTimeElapsed=t),this.drawMap(this.ctx,this.canvas),this.drawAttackArc(this.ctx,this.player),this.language){case"chinese":this.drawChineseEnemies(this.enemies,this.player),this.drawChineseTypingArea(this.ctx,this.canvas,this.fontSize);break;case"english":this.drawEnemies(this.enemies,this.player),this.drawTypingArea(this.ctx,this.canvas,this.fontSize)}this.drawWPM(this.ctx,this.canvas,this.fontSize),this.drawHeart(this.ctx),this.player.checkCollision(),this.player.animate(),this.isPaused&&console.log("pause hits animation"),this.isPaused||this.isGameOver||(this.request=requestAnimationFrame(t=>{this.animate(t)}))}}gameLoop(){"chinese"===this.gameMode&&(this._detachListeners(),this._addListeners()),this.trie=new o,this.enemies=[],this.player=new r(300,300,this.canvas,this.ctx,this.cronoleftimg,this.cronorightimg,this.cronoupimg,this.cronodownimg,this.cronothrust,this.keys,this.enemies),h.a.addCheats(),this.animate()}spawnEnemy(){var t=new n(Math.floor(Math.random()*this.canvas.width+1),Math.floor(Math.random()*this.canvas.height+1),this.canvas,this.ctx,this.imp,1,this.bluepaint,this.gameMode,this.squarereticle,this.dictionary);this.enemies.push(t),this.trie.addWord(t.word),this.isGameover}_getResources(){this.canvas=document.getElementById("canvas"),this.ctx=this.canvas.getContext("2d"),this.cronoleftimg=document.getElementById("cronoleft"),this.cronorightimg=document.getElementById("cronoright"),this.cronodownimg=document.getElementById("cronodown"),this.cronoupimg=document.getElementById("cronoup"),this.forestbg=document.getElementById("forest"),this.imp=document.getElementById("imp"),this.cronothrust=document.getElementById("cronothrust"),this.bluepaint=document.getElementById("bluepaint"),this.splash=document.getElementById("splash"),this.cursor=document.getElementById("cursor"),this.squarereticle=document.getElementById("squarereticle")}_addListeners(){var t=this;function e(t){var e={37:!0,38:!0,39:!0,40:!0,32:!0};Object.freeze(e),e[t.keyCode]&&t.preventDefault()}if(this.keys=[],this.word=[],"english"===this.gameMode)this.keydownHandler=t=>{var i=t.keyCode;this.keys[i]=!0,e(t),i>=65&&i<=90?this.word.push(String.fromCharCode(i).toLowerCase()):32!==i||this.isGameover?8===i?this.word.pop():13===i&&(this.onSplash?this.onSplash=!1:(this.handleSubmit(),this.word=[])):this.isPaused?this.isPaused&&this.unpause():this.pause()};else if("chinese"===this.gameMode){this.rate/=1/4,this.chineseInput=document.createElement("input"),this.chineseInput.setAttribute("placeholder","饱经沧桑"),this.chineseInput.style.height="0",this.chineseInput.style.width="0",this.chineseInput.style.margin="0",this.chineseInput.style.display="none",this.chineseAdvisoryText=document.createTextNode("Type chinese here"),this.chineseInput.style.position="absolute",document.body.insertBefore(this.chineseInput,document.body.children[document.body.children.length-1]),this.chineseInput.style.height="40px",this.chineseInput.style.width="180px",this.chineseInput.style.margin="2px";var i=function e(){var i=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];t.chineseInput.style.left=t.canvas.getBoundingClientRect().x+"px",t.chineseInput.style.top=t.canvas.getBoundingClientRect().bottom-(t.fontSize?t.fontSize:40)+"px",t.chineseInput.style.display="block",i&&window.addEventListener("resize",t.chineseListener=()=>e(!1))};i(),setTimeout(()=>i(!1),100),this.keydownHandler=t=>{var i=t.keyCode;this.keys[i]=!0,e(t),this.chineseInput.focus(),this.word=this.chineseInput.value,32!==i||this.isGameover?13===i&&(this.onSplash?this.onSplash=!1:this.handleChineseSubmit()):this.isPaused?this.isPaused&&this.unpause():this.pause()}}this.keyupHandler=t=>{this.keys[t.keyCode]=!1},document.body.addEventListener("keydown",this.keydownHandler,!0),document.body.addEventListener("keyup",this.keyupHandler,!0)}handleChineseSubmit(){this.word=this.chineseInput.value,this.player&&"edward"===this.word&&(this.player.hp=1/0);for(var t=0;t<this.enemies.length;t++)this.enemies[t].word===this.word&&!0===this.enemies[t].alive&&(this.player.animateAttack(this.enemies[t].x,this.enemies[t].y-50,this.cronothrust),this.enemies[t].alive=!1,socket.emit("word typed",this.word),this.destroyedCount>=1?this.destroyedCount++:this.destroyedCount=1);this.chineseInput.value=""}_detachListeners(){this.chineseInput&&(window.removeEventListener("resize",this.chineseListener),this.chineseInput.remove()),document.body.removeEventListener("keydown",this.keydownHandler,!0),document.body.removeEventListener("keyup",this.keyupHandler,!0),this.keys=[],this.word=[]}animateGameover(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,i=arguments.length>2?arguments[2]:void 0;this.ctx.font="bold 100px",this.initialAnimateGameoverTime||(this.initialAnimateGameoverTime=t);var s=e-~~((t-this.initialAnimateGameoverTime)/1e3);this.ctx.fillText("GAMEOVER!",.4*this.canvas.width,.5*this.canvas.height),i!==s&&this.ctx.fillText("".concat(s),.5*this.canvas.width,.9*this.canvas.height-this.fontSize*s),console.log(this.initialAnimateGameoverTime),this.ctx.font="bold 60px ChronoType",this.ctx.fillStyle="red",!0===this.onGameover&&requestAnimationFrame(t=>{this.animateGameover(t,e,s)})}createHighscoreDialogBox(){var t=this;return c((function*(){var e=prompt("NEW HIGH SCORE! Please enter your moniker!\n                                You destroyed ".concat(t.destroyedCount||0," monsters!"),"Name"),i=yield fetch("./highscore",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify([t.destroyedCount||0,e||"unnamed"])}).then(t=>t.json());h.a.deleteScores(),h.a.createScoreTable(i)}))()}gameover(){var t=this;return c((function*(){t.onGameover=!0,t._detachListeners(),yield fetch("./newhighscore",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify([t.destroyedCount||0,"irrelevant!"])}).then(t=>t.json()).then(e=>{!0===e&&t.createHighscoreDialogBox()}),cancelAnimationFrame(t.request),setTimeout(()=>{t.onGameover=!1,h.a.destroyerOfObjects(),window.game=new d},3e3),t.animateGameover()}))()}pause(){this.isPaused=!0,this.drawWPM(),this.ctx.font="bold 50px ChronoType",this.ctx.fillStyle="red",this.ctx.fillText("PRESS SPACEBAR TO UNPAUSE",.2*this.canvas.width,.5*this.canvas.height)}unpause(){this.isPaused=!1,this.animate()}handleSubmit(){this.player&&"edward"===this.word.join("")&&(this.player.hp=1/0);for(var t=0;t<this.enemies.length;t++)this.enemies[t].word===this.word.join("")&&!0===this.enemies[t].alive&&(this.player.animateAttack(this.enemies[t].x,this.enemies[t].y-50,this.cronothrust),console.log(socket),socket.emit("word typed",this.word.join("")),this.enemies[t].alive=!1,this.destroyedCount>=1?this.destroyedCount++:this.destroyedCount=1)}}var u=function(){"english"===this.gameMode?i.e(1).then(i.bind(null,3)).then(t=>{var{englishDictionary:e}=t;console.log("ENG DICITONARY DLED"),this.dictionary=e,this.word=[],this.gameLoop()}).catch(t=>{alert(t)}):"chinese"===this.gameMode&&i.e(0).then(i.bind(null,4)).then(t=>{var{chineseDictionary:e}=t;console.log("CN DICITONARY DLED"),this.dictionary=e,this.word=[],this.gameLoop()}).catch(t=>{alert(t)})},p=d;document.addEventListener("DOMContentLoaded",()=>{h.a.styleTooltip(),h.a.handleClipboard(),h.a.fetchScores(),h.a.attachChatToCanvasLeft(),window.game=new p})}]);